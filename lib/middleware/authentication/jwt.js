import a from'jsonwebtoken';var c=(n,t)=>(o,s,i)=>{let e=o.headers.authorization?.split(" ")[1];if(!e&&t&&(e=o.signedCookies?.[t]??o.cookies?.[t]),!e)throw s.status(401),new Error("No authorization header or cookie");try{let r=a.verify(e,n);o.jwt={token:e,decoded:r};}catch(r){throw s.status(401),r}i();};export{c as jwt};
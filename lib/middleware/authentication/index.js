import i from'jsonwebtoken';var a=(e,o,r)=>{let t=e.ip??e.socket.remoteAddress;if(t!=="::1"&&t!=="localhost")throw o.status(401),new Error("Unauthorized");r();};var l=(e,o,r={})=>(t,s,n)=>{try{t.jwt=Object.assign(i.verify(e,o,Object.assign(r,{complete:!0})),{raw:e});}catch(c){throw s.status(401),c}n();};export{l as jwt,a as local};
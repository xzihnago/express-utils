import a from'jsonwebtoken';var d=(s,o,e)=>{let t=s.ip??s.socket.remoteAddress;if(t!=="::1"&&t!=="localhost")throw o.status(401),new Error("Unauthorized");e();};var l=(s,o)=>(e,t,i)=>{let r=e.headers.authorization?.split(" ")[1];if(!r&&o&&(r=e.signedCookies?.[o]??e.cookies?.[o]),!r)throw t.status(401),new Error("No authorization header or cookie");try{let n=a.verify(r,s);e.jwt={token:r,decoded:n};}catch(n){throw t.status(401),n}i();};export{l as jwt,d as local};
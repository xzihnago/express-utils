import {format,transports,createLogger}from'winston';import'winston-daily-rotate-file';import d from'bcrypt';import l from'crypto';var T=Object.defineProperty;var c=(t,e)=>{for(var s in e)T(t,s,{get:e[s],enumerable:true});};var f={};c(f,{ANSI:()=>p,colorize:()=>n,logger:()=>L});var p=(r=>(r.RESET="\x1B[0m",r.FAINT="\x1B[2m",r.RED="\x1B[31m",r.GREEN="\x1B[32m",r.YELLOW="\x1B[33m",r.BLUE="\x1B[34m",r.MAGENTA="\x1B[35m",r.BOLD_RED="\x1B[1;31m",r))(p||{}),n=(t,e)=>`${e}${t}\x1B[0m`;var u=format.combine(format.timestamp(),format(t=>(t.level=t.level.toUpperCase().padStart(7),t))()),B=new transports.Console({format:format.combine(u,format.colorize(),format.printf(t=>{let e=t.message;return [n(t.timestamp,"\x1B[2m"),t.level,n(`[${e.ip??e.socket.remoteAddress??"unknown"}]`,"\x1B[35m"),n(e.method,"\x1B[33m"),e.path].join(" ")}))}),v=new transports.DailyRotateFile({format:format.combine(u,format.printf(t=>{let e=t.message;return [t.timestamp,t.level,`[${e.ip??e.socket.remoteAddress??"unknown"}]`,e.method,e.path].join(" ")})),auditFile:"logs/.audit",filename:"logs/%DATE%.log",maxFiles:"28d"}),L=createLogger({level:"debug",transports:[B,v],handleExceptions:true,handleRejections:true});var b={};c(b,{bcrypt:()=>i,hmac:()=>x});var i={};c(i,{hash:()=>w,verify:()=>k});var w=async t=>d.hash(t,10),k=async(t,e)=>d.compare(t,e);var x={};c(x,{hash:()=>q,verify:()=>D});var q=(t,e="sha256",s="base64")=>{let a=l.randomBytes(16),m=l.createHmac(e,a).update(t);return Buffer.concat([a,m.digest()]).toString(s)},D=(t,e,s="sha256",a="base64")=>{let m=Buffer.from(e,a),[h,E]=[m.subarray(0,16),m.subarray(16)],y=l.createHmac(s,h).update(t);return E.toString(a)===y.digest(a)};export{f as logging,b as password};